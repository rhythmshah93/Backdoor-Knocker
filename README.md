# Backdoor-Knocker
KNOCKER:
The knocker will first check that all the required arguments have been provided, else it will exit. Then the knocker will check the directory for the give configuration file. If the file is not found, the knocker will exit with a message indicating that file wasn't found. Else, it will parse the file and store the port numbers in a vector. Next it will create a raw socket, a char array to store the packet to be sent and an object of struct sockaddr describing the destination. This object will have it's IP address as the one given as an argument. The size of the packet has been arbitarily defined as 4096 but could be changed by modifying the prepocessor directive defining PACKET_SIZE. Now, the TCP and IP headers are filled and the socket is set and it is indicated to the kernel that the IP header has been included. The knocker will now iterate through the list of the given port numbers, setting the TCP field accordingly and send the packets, and exit after closing the socket.

BACKDOOR:
Like the knocker, the backdoor first checks that allthe required arguments are provided and if so,that the configuration fileis accessible. Else, the backdoor will exit with the relevant message. Next, it will create a raw socket that listens for packets of TCP protocol and stores the packet received on this socket to a buffer. Every time a packet is received, it will checkthe ort number to verify whether it is the expected one. The backdoor will keep doing this untill the sequence has been observed or 100 packets have been observed, whichever occurs first. The number of packets observed can be changed by modifying the MAX_PACKETS preprocessor directive. 
If the sequence is observed, a normal STREAMING socket is created and an object of struct sockaddr. This object will have it's IP address defined by resolving the URL given. After connecting with the target described by the sockaddr object, a GET request is sent which. The respose is stored in a buffer and it is parsed to get the body content. The parsing is done using a string tokenizer which uses "\r\n\r\n" as a delimiter as the header is always followed by that according to the RFC standard. Assuming that the body contains just the command and nothing else, for example - an actual HTML page, the tokenizer's last element would be the command. This command is then executed using the system() funtion call. The created sockets are closed and the backdoor exits.
